---

layout: post
title: "智能钥匙——汽车防盗系统：（三）PEPS无钥匙进入及启动系统"
date: 2021-05-10
tag: 车身电子


---


无钥匙进入及启动系统, 简称PEPS (Passive EntryPassive Start) 系统, 它采用先进的RFID 无线射频技术和车辆身份编码识别系统, 实现无需按动遥控器即可进入车内以及一键启动发动机等功能

当驾驶员携带智能钥匙进入车辆附近的有效范围内, 车辆会自动检测钥匙并进行身份识别. 如果身份识别成功, 相应门锁会解除防盗并自动打开. 当驾驶员进入车内时, 车辆会自动检测钥匙是否位于主驾位置. 如果检测成功, 驾驶员想要启动车辆, 只需通过按下启动按钮即可. 在整个开门上车到启动车辆过程, 驾驶员都无需拿出车钥匙.PEPS 系统的应用, 给用户带来更加舒适的体验以及更为安全的保障. 与传统的钥匙相比, 具有更高的防盗性能, 并给驾驶员带来了舒适、便利的全新驾车体验.

### 系统框图

![image-20210624134102483](\images\posts\peps\image-20210624134102483.png)

PEPS 系框图说明

1） 整个系统由智能钥匙、PEPS 控制器（带PDU 功能）、IMMO 基站、SSB 启停开关等3
部分组成。
2） PEPS 控制器、BCM 模块、ABS 模块、EMS 模块、IPK 模块之间采用高速CAN 通讯。
3） PEPS 控制器与IMMO 基站之间采用LIN 通讯。
4） SSB 启停开关采用1 路（SW1）硬线输入，另一路(SW2)由BCM 控制；
5） 电源分配有两路输出；
6） PEPS 内部集成发动机防盗算法。

### PEPS功能

#### PKE解闭锁

1. 收到司机门侧把手按键信号，发送按键信息唤醒CAN 网络；
2. 判断当前门锁状态是否为闭锁状态（即司机门锁闭锁状态），如果是，则执行第3 步；如果不是，则执行闭锁逻辑（见PKE 司机门侧无钥匙闭锁功能）；
3. 查找司机门侧的车外钥匙，如果未找到车外钥匙，则等待再次进入休眠；如果找到车外钥匙，则判断电源档位，如果当前电源档位为OFF 状态，则进行第4 步，否则不动作；
4. 发送PKE 解锁命令（以20ms周期连发3 次后，切换到100ms的周期帧，持续时间200ms，注：如果在命令发送未结束时收到新的命令，则立即切换为发送新的命令）；

#### RKE解闭锁

1. PEPS 收到RF 解锁信号；

2. 如果电源档位处于OFF 状态，不作门锁状态的判断，直接转发RKE 解锁命令（以20ms 周期连发3 次后，切换到100ms 的周期帧，持续时间200ms，注：如果在命令发送未结束时收到新的命令，则立即切换为发送新的命令）；如果电源档位为非OFF 状态，则不转发RKE 命令。

#### PKS一键启动功能

1. 启动按钮按下时，触发查找车内钥匙，如果找到车内有合法钥匙（含车内钥匙和备用启动钥
   匙），则AMT 车型档位切换到ON档，继续执行第2 步，MT 车型执行第2 步；否则，终止动作，电源档位不变。

2. PEPS 通过LIN 通信向ESCL 发送解锁认证请求，认证成功后，ESCL 执行解锁动作。PEPS 检测ESCL 解锁成功，档位切换到ON档，执行第3 步；否则，终止动作，电源档位不变；

3. PEPS 在ON 档判断刹车(AMT)或离合（MT）是否踩下；如果是，则AMT 车型执行第4 步，MT 车型执行第5 步；如果不是，则终止启动，档位切换到ON 档。

4. PEPS 判断换档机构是否在N档（以取总线信号优先，总线不在线取硬线信号,Pending on 时
   间t=400ms），如果是，执行第5步；如果不是，则终止启动，档位切换到ON 档。

5. 等待EMS 的Challenge 请求，如果在2s 内收到EMS 的Challenge 请求，则执行第7 步；如果2s 内未收到EMS 的Challenge 请求，则切换电源档位到ACC 档；

7. 收到EMS 的Challenge 请求后，与EMS 进行防盗认证：
   1）如果PEPS 认证EMS 通过，则发送Response 数据（填充算法计算后的结果）给EMS。继续执行第9 步；
   2）如果PEPS 认证EMS 不通过，则切换到ACC 档，则发送Response 数据（填充全FF）给
   EMS，提示“发动机防盗认证失败”，并中止此次SSB 按下的后续操作；

9. PEPS 等待EMS 的防盗认证结
   果：
   1）如果PEPS 在2.5s 内收到EMS防盗认证标志为Pass，则执行第10 步；
   2）如果PEPS 在2.5s 内收到EMS防盗认证标志为Fail 或2.5s 定时超时，则切换到ACC 档，提示“发动机防盗认证失败”，并中止此次SSB 按下的后续操作；

10. PEPS 检测内部标识，如果是汽油车车型，则执行第12 步，如果是柴油车车型，则执行第11步；

11. PEPS 检测EMS 发送引擎预热状态信号，如果为OFF，则执行第12 步；如果为ON，则等待引擎预热完成，如果3s 内预热信号变为OFF，则执行第12 步，否则，终止此次SSB 按下的后续操作，电源档位保持在ON 档，同时发出“等待预热的告警信息”；

12. 切换档位到CRANK，发送CrankRequest 给EMS，同时启动15s 定时，继续执行第15 步；
    15、PEPS 根据发动机运行状态信号进行判断：
    1）如果PEPS 在15s 内未收到EMS报文，15s 超时后PEPS 切换电源档位到RUN 档，并清除CrankRequest 信号；
    2）如果PEPS 检测EMS 发出的引擎状态是否为True 状态。如果15s 内PEPS 检测到引擎状态为True，则PEPS 直接判断发动机启动成功，切换电源档位到RUN 档；如果15s 内PEPS 检测到引擎状态一直为非True，15s 超时后，PEPS切换电源档位到ON（启动失败）档。执行完后，PEPS 清除CrankRequest 信号；

16. PEPS 电源档位在ON 档以上，EMS 与PEPS 认证通过后电源档位下切至OFF/ACC 会维持6s 有效期；

#### PDU

PEPS 和BCM 联合控制系统的PDU 功能，其中PEPS 根据启动按键、刹车、智能钥匙等逻辑进行控制对BCM 的两路硬线输出，表征四个状态，代表不同的电源档位。而BCM 作为PDU 的执行器，正常模式下只根据PEPS 的输出来进行电源档位的控制。