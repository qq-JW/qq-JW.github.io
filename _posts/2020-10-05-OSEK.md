---

layout: post
title: "OSEK网络管理综述"
date: 2020-10-05
tag: CAN


---
由前所知，需要进行直接网络管理的ECU在KL15下电后依然需要保持工作，且要支持低功耗模式，通过网络管理来控制ECU的睡眠和唤醒，直接网络管理的主要目的是：同步关闭一个CAN网段中的所有电控单元。

OSEK网络管理则是使用令牌环机制建立一个逻辑环，从而控制网段中所有的电控单元：

1. 如果一个电控单元需要CAN通信，将发送一个激活报文。通知网络上的其它电控单元：此电控单元加入网络。这个报文具有特殊的意义，因为它唤醒了所有其它电控单元，因此其被命名为：唤醒报文。
2. 所有的电控单元构造了一个逻辑环，同时有规律地向各自的逻辑后继者发送同步环报文，以此来监控已建立的环。
3. 如果一个电控单元不再需要CAN通信，它将在发送的环报文中设置睡眠指示标志置位，以通知其它电控单元。当逻辑环中所有的电控单元都发送了休眠指示，某个电控单元通过发送设置睡眠应答标志位的环报文，初始网络关闭的同步转换。

网络管理报文格式：

![image-20210624100718356](\images\posts\osek\image-20210624100718356.png)

### 如下，是总线睡眠报文示例：

![image-20210624094715395](\images\posts\osek\image-20210624094715395.png)

### 如下，是跛行回家报文示例：

![image-20210624095226838](\images\posts\osek\image-20210624095226838.png)

### 如下，是网络中加入新的节点：

![image-20210624095629761](\images\posts\osek\image-20210624095629761.png)

### 如下，是RING报文节点丢失示例：

![image-20210624095302504](\images\posts\osek\image-20210624095302504.png)